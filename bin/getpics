#!/usr/bin/env ruby

require "bundler/setup"
require "getpics"
require 'optparse'

ARGV << '-h' if ARGV.empty?

options = {}
OptionParser.new do |opts|
    opts.banner = "Usage: getpics [options]"

    opts.on("-s", "--src DIR", "Source directory") do |s|
        options[:src] = s
    end

    opts.on("-d", "--dest DIR", "Destination directory") do |d|
        options[:dest] = d
    end

    opts.on("-v", "--verbose", "Verbose") do |v|
        options[:verbose] = v
    end

    opts.on_tail("-h", "--help", "Show this message") do
        puts opts
        exit
    end
end.parse!

dl = Getpics::Downloader.new(options[:verbose])
dl.load_pics(options[:src])
dl.copy_pics(options[:dest])

puts "Do you want to delete the pictures from #{options[:src]}? [y/N]".yellow
delete = gets.strip
if delete == 'y'
    dl.delete_pics
end

puts "All finished!".green
